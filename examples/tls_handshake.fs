# This example demonstrates a TLS handshake between client and server.

flow default tcp 192.168.106.72:40015 > 172.16.14.121:443 (tcp.initialize;);

## Client Hello
default > (
content:"\x80\x80"; #Length
content:"\x01"; # Handshake Message Type (Client Hello)
content:"\x03\x01"; # Version (TLS 1.0)
content:"\x00\x57"; # Cipher Spec length 
content:"\x00\x00"; # Session ID Length
content:"\x00\x20"; # Challenge Length (32)
content:"\x00\x009\x00\x008\x00\x005\x00\x00\x16\x00\x00\x13\x00\x00\x0a\x07\x00\xc0\x00\x003\x00\x002\x00\x00/\x00\x00\x9a\x00\x00\x99\x00\x00\x96\x03\x00\x80\x00\x00\x05\x00\x00\x04\x01\x00\x80\x00\x00\x15\x00\x00\x12\x00\x00\x09\x06\x00@\x00\x00\x14\x00\x00\x11\x00\x00\x08\x00\x00\x06\x04\x00\x80\x00\x00\x03\x02\x00\x80\x00\x00\xff"; # Cipher spec list
content:"\xf2\xb4X\xf2.\xbe\x9d#d8hZ\xe3J\xdf\xe4\xce\xc5\x8f\xab\xa3\xd0\xc4\xa1\xb1\xa1\xc1\x80G'K<"; ); # Challenge
## Server Hello and Certificate
default < (
### Server Hello
content:"\x16\x03\x01\x00Q\x02\x00\x00M\x03\x01U\xe8\x83\x0f\xa1\xe8\xcd\xc6^k\xae`\xf4\xbe\x0er\xab~w,\xce\xf6L\x89#\xc9\xbaU\x8b\xae\x0ef\x20\xcf\xb4\xc1\xb9\xb0-\x1e\xe6Zl\x0f\xff\xfd\xe3)\x97\x89cy\xa9\xdbNV\x83\xa5\x97:\x12Td\x09\xac\x009\x00\x00\x05\xff\x01\x00\x01\x00";
### Certificates Handshake
content:"\x16"; # Type Handshake
content:"\x03\x01"; # Version (TLS 1.0)
content:"\x04\x36"; # Handshake length: Certificate length + 10 (2 bytes)
#### Handshake type Certificate
content:"\x0b"; # Handshake type: Certificate
content:"\x00\x04\x32"; # Certificate Handshake length: Certificate length + 6 (3 bytes)
content:"\x00\x04\x2f"; # Certificates length: Certificate length + 3 (3 bytes)
content:"\x00\x04\x2c"; # Certificate Length (3 bytes)
content:"\x30\x82\x04\x28\x30\x82\x03\x10\xa0\x03\x02\x01\x02\x02\x10\x01\x00\x21\x25\x88\xb0\xfa\x59\xa7\x77\xef\x05\x7b\x66\x27\xdf\x30\x0d\x06\x09\x2a\x86\x48\x86\xf7\x0d\x01\x01\x0b\x05\x00\x30\x42\x31\x0b\x30\x09\x06\x03\x55\x04\x06\x13\x02\x55\x53\x31\x16\x30\x14\x06\x03\x55\x04\x0a\x13\x0d\x47\x65\x6f\x54\x72\x75\x73\x74\x20\x49\x6e\x63\x2e\x31\x1b\x30\x19\x06\x03\x55\x04\x03\x13\x12\x47\x65\x6f\x54\x72\x75\x73\x74\x20\x47\x6c\x6f\x62\x61\x6c\x20\x43\x41\x30\x1e\x17\x0d\x31\x37\x30\x35\x32\x32\x31\x31\x33\x32\x33\x37\x5a\x17\x0d\x31\x38\x31\x32\x33\x31\x32\x33\x35\x39\x35\x39\x5a\x30\x49\x31\x0b\x30\x09\x06\x03\x55\x04\x06\x13\x02\x55\x53\x31\x13\x30\x11\x06\x03\x55\x04\x0a\x13\x0a\x47\x6f\x6f\x67\x6c\x65\x20\x49\x6e\x63\x31\x25\x30\x23\x06\x03\x55\x04\x03\x13\x1c\x47\x6f\x6f\x67\x6c\x65\x20\x49\x6e\x74\x65\x72\x6e\x65\x74\x20\x41\x75\x74\x68\x6f\x72\x69\x74\x79\x20\x47\x32\x30\x82\x01\x22\x30\x0d\x06\x09\x2a\x86\x48\x86\xf7\x0d\x01\x01\x01\x05\x00\x03\x82\x01\x0f\x00\x30\x82\x01\x0a\x02\x82\x01\x01\x00\x9c\x2a\x04\x77\x5c\xd8\x50\x91\x3a\x06\xa3\x82\xe0\xd8\x50\x48\xbc\x89\x3f\xf1\x19\x70\x1a\x88\x46\x7e\xe0\x8f\xc5\xf1\x89\xce\x21\xee\x5a\xfe\x61\x0d\xb7\x32\x44\x89\xa0\x74\x0b\x53\x4f\x55\xa4\xce\x82\x62\x95\xee\xeb\x59\x5f\xc6\xe1\x05\x80\x12\xc4\x5e\x94\x3f\xbc\x5b\x48\x38\xf4\x53\xf7\x24\xe6\xfb\x91\xe9\x15\xc4\xcf\xf4\x53\x0d\xf4\x4a\xfc\x9f\x54\xde\x7d\xbe\xa0\x6b\x6f\x87\xc0\xd0\x50\x1f\x28\x30\x03\x40\xda\x08\x73\x51\x6c\x7f\xff\x3a\x3c\xa7\x37\x06\x8e\xbd\x4b\x11\x04\xeb\x7d\x24\xde\xe6\xf9\xfc\x31\x71\xfb\x94\xd5\x60\xf3\x2e\x4a\xaf\x42\xd2\xcb\xea\xc4\x6a\x1a\xb2\xcc\x53\xdd\x15\x4b\x8b\x1f\xc8\x19\x61\x1f\xcd\x9d\xa8\x3e\x63\x2b\x84\x35\x69\x65\x84\xc8\x19\xc5\x46\x22\xf8\x53\x95\xbe\xe3\x80\x4a\x10\xc6\x2a\xec\xba\x97\x20\x11\xc7\x39\x99\x10\x04\xa0\xf0\x61\x7a\x95\x25\x8c\x4e\x52\x75\xe2\xb6\xed\x08\xca\x14\xfc\xce\x22\x6a\xb3\x4e\xcf\x46\x03\x97\x97\x03\x7e\xc0\xb1\xde\x7b\xaf\x45\x33\xcf\xba\x3e\x71\xb7\xde\xf4\x25\x25\xc2\x0d\x35\x89\x9d\x9d\xfb\x0e\x11\x79\x89\x1e\x37\xc5\xaf\x8e\x72\x69\x02\x03\x01\x00\x01\xa3\x82\x01\x11\x30\x82\x01\x0d\x30\x1f\x06\x03\x55\x1d\x23\x04\x18\x30\x16\x80\x14\xc0\x7a\x98\x68\x8d\x89\xfb\xab\x05\x64\x0c\x11\x7d\xaa\x7d\x65\xb8\xca\xcc\x4e\x30\x1d\x06\x03\x55\x1d\x0e\x04\x16\x04\x14\x4a\xdd\x06\x16\x1b\xbc\xf6\x68\xb5\x76\xf5\x81\xb6\xbb\x62\x1a\xba\x5a\x81\x2f\x30\x0e\x06\x03\x55\x1d\x0f\x01\x01\xff\x04\x04\x03\x02\x01\x06\x30\x2e\x06\x08\x2b\x06\x01\x05\x05\x07\x01\x01\x04\x22\x30\x20\x30\x1e\x06\x08\x2b\x06\x01\x05\x05\x07\x30\x01\x86\x12\x68\x74\x74\x70\x3a\x2f\x2f\x67\x2e\x73\x79\x6d\x63\x64\x2e\x63\x6f\x6d\x30\x12\x06\x03\x55\x1d\x13\x01\x01\xff\x04\x08\x30\x06\x01\x01\xff\x02\x01\x00\x30\x35\x06\x03\x55\x1d\x1f\x04\x2e\x30\x2c\x30\x2a\xa0\x28\xa0\x26\x86\x24\x68\x74\x74\x70\x3a\x2f\x2f\x67\x2e\x73\x79\x6d\x63\x62\x2e\x63\x6f\x6d\x2f\x63\x72\x6c\x73\x2f\x67\x74\x67\x6c\x6f\x62\x61\x6c\x2e\x63\x72\x6c\x30\x21\x06\x03\x55\x1d\x20\x04\x1a\x30\x18\x30\x0c\x06\x0a\x2b\x06\x01\x04\x01\xd6\x79\x02\x05\x01\x30\x08\x06\x06\x67\x81\x0c\x01\x02\x02\x30\x1d\x06\x03\x55\x1d\x25\x04\x16\x30\x14\x06\x08\x2b\x06\x01\x05\x05\x07\x03\x01\x06\x08\x2b\x06\x01\x05\x05\x07\x03\x02\x30\x0d\x06\x09\x2a\x86\x48\x86\xf7\x0d\x01\x01\x0b\x05\x00\x03\x82\x01\x01\x00\xca\x49\xe5\xac\xd7\x64\x64\x77\x5b\xbe\x71\xfa\xcf\xf4\x1e\x23\xc7\x9a\x69\x63\x54\x5f\xeb\x4c\xd6\x19\x28\x23\x64\x66\x8e\x1c\xc7\x87\x80\x64\x5f\x04\x8b\x26\xaf\x98\xdf\x0a\x70\xbc\xbc\x19\x3d\xee\x7b\x33\xa9\x7f\xbd\xf4\x05\xd4\x70\xbb\x05\x26\x79\xea\x9a\xc7\x98\xb9\x07\x19\x65\x34\xcc\x3c\xe9\x3f\xc5\x01\xfa\x6f\x0c\x7e\xdb\x7a\x70\x5c\x4c\xfe\x2d\x00\xf0\xca\xbe\x2d\x8e\xb4\xa8\x80\xfb\x01\x13\x88\xcb\x9c\x3f\xe5\xbb\x77\xca\x3a\x67\x36\xf3\xce\xd5\x27\x02\x72\x43\xa0\xbd\x6e\x02\xf1\x47\x05\x71\x3e\x01\x59\xe9\x11\x9e\x1a\xf3\x84\x0f\x80\xa6\xa2\x78\x35\x2f\xb6\xc7\xa2\x7f\x17\x7c\xe1\x8b\x56\xae\xee\x67\x88\x51\x27\x30\x60\xa5\x62\x52\xc3\x37\xd5\x3b\xea\x85\x2a\x01\x38\x87\xa2\xcf\x70\xad\xa4\x7a\xc9\xc4\xe7\xca\xc5\xda\xbc\x23\x32\xf2\xfe\x18\xc2\x7b\xe0\xdf\x3b\x2f\xd4\xd0\x10\xe6\x96\x4c\xfb\x44\xb7\x21\x64\x0d\xb9\x00\x94\x30\x12\x26\x87\x58\x98\x39\x05\x38\x0f\xcc\x82\x48\x0c\x0a\x47\x66\xee\xbf\xb4\x5f\xc4\xff\x70\xa8\xe1\x7f\x8b\x79\x2b\xb8\x65\x32\xa3\xb9\xb7\x31\xe9\x0a\xf5\xf6\x1f\x32\xdc"; # DER certificate bytes
### Server Key Exchange
content:"\x16\x03\x01\x01\x8d\x0c\x00\x01\x89\x00\x80\xbb\xbc-\xca\xd8Ft\x90|C\xfc\xf5\x80\xe9\xcf\xdb\xd9X\xa3\xf5h\xb4-K\x08\xee\xd4\xeb\x0f\xb3PLl\x03\x02v\xe7\x10\x80\x0c\\xcb\xba\xa8\x92&\x14\xc5\xbe\xec\xa5e\xa5\xfd\xf1\xd2\x87\xa2\xbc\x04\x9b\xe6w\x80`\xe9\x1a\x92\xa7W\xe3\x04\x8fh\xb0v\xf7\xd3l\xc8\xf2\x9b\xa5\xdf\x81\xdc,\xa7%\xec\xe6bp\xcc\x9aP5\xd8\xce\xce\xef\x9e\xa0'Jc\xab\x1eX\xfa\xfdI\x88\xd0\xf6]\x14gW\xda\x07\x1d\xf0E\xcf\xe1k\x9b\x00\x01\x02\x00\x80\xa9\xc5y)\U\x00\x1f\xa30\x9b\x8e\xd6.\xed\x01\xe9VY0\x9e\x03\x95\x1b\x88[q\xdd\xfd\x16\x0e\x1a\xc3\xbd\xd3\x1c\xbc\x92\xa1o\xed\xa5T\xea\xaa\xf7\xdd\xcd\xd7\xb8\x20E\x9b\x1a\xd4H}[\xf46\x98dL\x0d\xb6<A\x98[\x8c\x95\xc5\\x0a\xef>\xfc\xb2\x0d\xf7\x94\xecv\xd5\x1f\xf2\x85;\xa6\xf6\xf2U\xcb\x16\xc4z\xa1/\xdeq\xf3\xb0\x20\x19\xef\xc8\xc9\xa5\x15\xae\x9f\xe9\x07:\x0d\x10\xbe\xc8\xb3\x98Zh\xe6k\x7f5\x1d\x8f\x00\x80\x19\xbb\x17\xd6e\x00\xc8Y\x95L\xde\xdb\x9b\xc7I\x20F\x96Po\xf8\xedV\x92\x85\xe5V\xf2zC\x06\xcb\xcc\xfe(\x82\x1c\x11\x9d\xb8\xd3wT\x9c\x08\xe6\x0aA\x06\xbax\xb8\x85\x94p+\x88/\xb4\x20%\x1bhx\xc462\xa4;\x9e\xe7\x98`\x01]<q)!\x9c\xe7\x8a6\xd4\xd9\xb6\x0f\xbc*\x0aV\xf6\x1cp\xb7\xf6[P\x85\xfc\x9f.\xc3\x14k\x0c\x80\xf7\x20\xf3\xf4\xac}\x14\xe66lz\xf5\xe9Yf\x07\x1a\x00f\x98\x90";
### Server Hello Done
content:"\x16\x03\x01\x00\x04\x0e\x00\x00\x00"; );